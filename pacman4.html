<!DOCTYPE html>
<html>
<head>
    <title>Animation</title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
    
    <!-- Stylesheets -->
    <link href="css/destyle.css" rel="stylesheet" />
    <link href="css/pacmanStyle.css" rel="stylesheet" />
    
    <!-- Google Font(s) -->
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	
	<!--JavaScript-->
	<script src="drawing.js"></script>
	<script src="objects.js"></script>
	
</head>
<body>

<div id="container">
	
	<h1>Animation</h1>
	
	<canvas id="pacman" width="300" height="300" tabindex = "1"></canvas>
	
	<script>
		
		// Concepts and codes from JavaScript 2D Game Development by Gaeme Stuart 
		var context = document.getElementById("pacman").getContext("2d"); 
		
		var pacman = new PacMan(context.canvas.width / 2, context.height / 2, 20, 120); 
		
		let ghosts = [
			
			new Ghost(Math.random() * 300, Math.random() * 300, 20, 70, 'red'); 
			
			new Ghost(Math.random() * 300, Math.random() * 300, 20, 60, 'pink');
			
			new Ghost(Math.random() * 300, Math.random() * 300, 20, 50, 'cyan'); 
			
			new Ghost(Math.random() * 300, Math.random() * 300, 20, 40, 'orange'); 
		]
		
		function draw(ctx, guide) {
			
			if(guide){
				
				draw_grid(ctx); 
			}
			
			pacman.draw(ctx); 
			
			ghosts.forEach(function(ghost) {
				
				ghost.draw(context, guide);
				
			});
			
		}
		
		function.update(elapsed) {
			
			pacman.update(elapsed, 300, 300); 
			
			ghosts.forEach(function(ghost) {
				
				ghost.update(pacman, elapsed); 
				
			}); 
			
		}
		
		var previous, elapsed; 
		
		function frame(timestamp) {
			
			context.clearRect(0, 0, context.canvas.width, context.canvas.height); 
			
			if(!previous) previous = timestamp; 
			
			elapsed = timestamp - previous; 
			
			update(elapsed / 1000); 
			
			draw(context, true); 
			
			previous = timestamp; 
			
			window.requestAnimationFrame(frame); 
	
		}
		
		window.requestAnimationFrame(frame); 
		
		function keydown_handler(e) {
			
			let key = e.key || e.keyCode;
			
			let nothing_handled = false; 
			
			switch(key) {
					
				case "ArrowLeft":
				
				case 37: // left arrrow keyCode
					
					pacman.move_left(); 
					
					break; 
				
				case "ArrowUp": 
					
				case 38: // up arrow keyCode
					
					pacman.move_up(); 
					
					break; 
				
				case "ArrowRight": 
					
				case 39: // right arrow keyCode
					
					pacman.move_right(); 
					
					break; 
					
				case "ArrowDown": 
					
				case 40: // down arrow keyCode
					
					pacman.move_down(); 
					
					break; 
				
				default:
					
					nothing_handled = true; 
			}
			
			if(!Nothing_handled) e.preventDefault(); 
		}
		
	</script>
	
</div>
</body>
</html>
